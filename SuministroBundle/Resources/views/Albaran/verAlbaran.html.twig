{% extends '::base.html.twig' %}

{% block title %}Albaran{% endblock %}

{% block stylesheets %}
	<link href="{{ asset('bundles/rgmelibreriaindex/css/albaran.css') }}" type="text/css" rel="stylesheet" />	
{% endblock %}

{% block body %}
	{% if error %}
	{{ error }}
	{% else %}
<div id="albaran_contenedor">
	<header id="albaran_header">
		Distribuidora: {{ albaran.contrato.distribuidora.nombre }}<br>
		Nº Albaran: {{ albaran.id }}<br>
		Fecha Realizacion: {{ albaran.fechaRealizacion|date('Y-m-d') }}<br>
		Fecha Factura: {{ albaran.fechaVencimiento|date('Y-m-d') }}<br>
	</header>
	<section id="albaran_cuerpo">
		<table>
			<tr>
				<th>ISBN/REF</th>
				<th>Titulo</th>
				<th>UDS.</th>
				<th>Vend.</th>
				<th>P.V.c/i</th>
				<th>P.V.s/i</th>
				<th>Desc</th>
				<th>Importe</th>
				<th>Iva</th>
			</tr>
			{% for l in lineas %}
				<tr>
					<td>{{ l.ref }}</td>
					<td>{{ l.titulo }}</td>
					<td>{{ l.numEjemplares }}</td>
					<td>{{ l.vendidos }}</td>
					<td>{{ '%.2f'|format(l.precio * (1 + l.iva)) }}€</td>
					<td>{{ '%.2f'|format(l.precio) }}€</td>
					<td>{{ l.desc * 100 }}%</td>
					<td>{{ '%.2f'|format(l.precio * (1 - l.desc)) }}€</td>
					<td>{{ l.iva * 100 }}%</td>
				</tr>
			{% endfor %}
		</table>
	</section>
	<footer id="albaran_footer">
		<section class="total_base">
			Total Base: <span class="cantidad">{{ '%.2f'|format(bImp) }}€</span><br>
			Total IVA: <span class="cantidad">{{ '%.2f'|format(bIva) }}€</span><br>
			Total REC: <span class="cantidad">{{ '%.2f'|format(bRec) }}€</span><br>
		</section>
		<section class="total">
			TOTAL €: <span class="cantidad">{{ '%.2f'|format(bTotal) }}€</span>
		</section>
		<section class="impuestos">
			<table>
				<tr>
					<th>I.V.A.</th>
					<th>REC.</th>
					<th>Base Imponible</th>
					<th>IMP I.V.A.</th>
					<th>IMP REC.</th>
				</tr>
				{% for base in bases %}
					{% if base.baseImp > 0 %}
						<tr>
							<td>{{ base.iva * 100 }}%</td>
							<td>{{ base.rec * 100 }}%</td>
							<td>{{ '%.2f'|format(base.baseImp) }}€</td>
							<td>{{ '%.2f'|format(base.ivaImp) }}€</td>
							<td>{{ '%.2f'|format(base.recImp) }}€</td>
						</tr>
					{% endif %}
				{% endfor %}
			</table>
		</section>
	</footer>
</div>
{% endif %}
{% endblock %}